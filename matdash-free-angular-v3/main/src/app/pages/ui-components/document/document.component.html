<mat-card class="p-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Mis Trámites</h2>
    <button mat-flat-button color="primary" routerLink="/ui-components/tramite">
      <mat-icon>add</mat-icon>
      Nuevo Trámite
    </button>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="cargando" class="text-center p-4">
    <p>Cargando trámites...</p>
  </div>

  <!-- Tabla de trámites -->
  <div *ngIf="!cargando">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-100">

      <!-- Número de Expediente -->
      <ng-container matColumnDef="numeroExpediente">
        <th mat-header-cell *matHeaderCellDef>Expediente</th>
        <td mat-cell *matCellDef="let item">{{ item.numeroExpediente || 'N/A' }}</td>
      </ng-container>

      <!-- Nombres -->
      <ng-container matColumnDef="nombres">
        <th mat-header-cell *matHeaderCellDef>Nombres</th>
        <td mat-cell *matCellDef="let item">{{ item.nombres || 'Cargando...' }}</td>
      </ng-container>

      <!-- Apellidos -->
      <ng-container matColumnDef="apellidos">
        <th mat-header-cell *matHeaderCellDef>Apellidos</th>
        <td mat-cell *matCellDef="let item">{{ item.apellidos || 'Cargando...' }}</td>
      </ng-container>

      <!-- DNI -->
      <ng-container matColumnDef="dni">
        <th mat-header-cell *matHeaderCellDef>DNI</th>
        <td mat-cell *matCellDef="let item">{{ item.dni || 'Cargando...' }}</td>
      </ng-container>

      <!-- Asunto -->
      <ng-container matColumnDef="asunto">
        <th mat-header-cell *matHeaderCellDef>Asunto</th>
        <td mat-cell *matCellDef="let item">{{ item.asunto || 'N/A' }}</td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let item">
          <mat-chip [color]="getEstadoColor(item.estado)" selected>
            {{ getEstadoTexto(item.estado) }}
          </mat-chip>
        </td>
      </ng-container>

      <!-- Fecha Inicio -->
      <ng-container matColumnDef="fechaInicio">
        <th mat-header-cell *matHeaderCellDef>Fecha Inicio</th>
        <td mat-cell *matCellDef="let item">
          {{ formatearFecha(item.fechaInicio) }}
        </td>
      </ng-container>

      <!-- Acciones - SOLO PDF -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Documento</th>
        <td mat-cell *matCellDef="let item">
          <button mat-icon-button color="primary" 
                  (click)="descargarDocumento(item)"
                  matTooltip="Descargar PDF">
            <mat-icon>picture_as_pdf</mat-icon>
          </button>
        </td>
      </ng-container>

      <!-- FILAS -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

    </table>

    <!-- Mensaje cuando no hay trámites -->
    <div *ngIf="tramitesCompletos.length === 0" class="text-center p-4">
      <mat-icon class="display-4 text-muted mb-3">folder_open</mat-icon>
      <h4 class="text-muted">No hay trámites registrados</h4>
      <p class="text-muted">Comience creando un nuevo trámite</p>
      <button mat-flat-button color="primary" routerLink="/ui-components/tramite">
        Crear Primer Trámite
      </button>
    </div>
  </div>
</mat-card>